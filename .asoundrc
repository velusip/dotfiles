pcm.revo
{
    #ice1724
    type hw
    card Revolution71
}

pcm.sb
{
    #alc889
    type hw
    card SB
}

pcm.nvidia
{
    #nvidia HDMI
    type hw
    card NVidia
}

pcm.dmix8
{
    # output to all M-Audio Revolution71 hardware channels
    type dmix
    ipc_key 1024
    ipc_key_add_uid false
    ipc_perm 0660
    slave
    {
        pcm revo
        rate 44100
        format S16_LE
        channels 8
        period_time 0
        period_size 1024
        buffer_time 0
        buffer_size 8192
    }
}

pcm.ch71dup
{
    # upmix to all channels
    type route
    slave.pcm dmix8
    slave.channels 8
    ttable.0.0 1   #right <- front right
    ttable.1.1 1   #left  <- front left
    ttable.0.2 0.6 #right <- rear left (60%)
    ttable.1.3 0.6 #left  <- rear right (60%)
    ttable.0.4 0.5 #right <- centre (50%)
    ttable.1.4 0.5 #left  <- centre (50%)
    ttable.0.5 0.5 #right <- LFE (50%)
    ttable.1.5 0.5 #left  <- LFE (50%)
    ttable.0.6 1   #right <- side left
    ttable.1.7 1   #left  <- side right
}

pcm.duplex
{
    # handle both input and output (muxless card)
    type asym
    playback.pcm ch71dup # upmix first while we're stuck on stereo
    capture.pcm
    {
        type plug
        slave.pcm sb
        #slave.pcm "dsnooped"
    }
}

pcm.!default
{
    type plug
    slave
    {
        pcm duplex
    }
}

defaults.ctl.card 2;
defaults.pcm.card 2;

#pcm.!default
#{
#    type plug
#    slave.pcm
#    {
#        type multi
#        slaves
#        {
#            a { channels 2 pcm duplex }  # the real device
#            b { channels 2 pcm "hw:0,0" }  # the loopback driver
#        }
#        bindings
#        {
#            0 { slave a channel 0 }
#            1 { slave a channel 1 }
#            2 { slave b channel 0 }
#            3 { slave b channel 1 }
#        }
#    }
#    ttable [
#        [ 1 0 1 0 ]   # left  -> a.left,  b.left
#        [ 0 1 0 1 ]   # right -> a.right, b.right
#    ]
#}

pcm.dsp0 duplex

pcm.10to20
{
    # spread mono to stereo
    type route
    slave.pcm default
    slave.channels 2
    ttable.0.0 1
    ttable.0.1 1
}

